<!--  
    EXEMPLO FEITO A PARTIR DO CURSO FRANK'S LABORATORY
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title> animação do cachorro exercicio Franks Laboratory</title>

</head>

<style>
    body{
        background-color: darkgray;
    }
    #canvas1{
        background-color: white;
        border: 5px solid blue;
        top: 50%;
        position: absolute;
        left: 50%;
        transform: translate(-50%,-50%);
        /** ele declarou aqui a altura e largura... pode ficar meio bugado declarar aqui */
        height:600px;
        width:600px;
    }
    div{
        display: flex;
        flex-direction: column;
        align-items: center;
    }
</style>

<body>
    <div>
        <input type="button" value="  1  " id="btn1" class="btn"/>
        <input type="button" value="  2  " id="btn2" class="btn"/>
        <input type="button" value="  3  " id="btn3" class="btn"/>
        <input type="button" value="  4  " id="btn4" class="btn"/>
        <input type="button" value="  5  " id="btn5" class="btn"/>
        <input type="button" value="  6  " id="btn6" class="btn"/>
        <input type="button" value="  7  " id="btn7" class="btn"/>
    </div>

    <canvas id="canvas1" class="canvas1" > <!-- mudei o W e H daqui -->
        ERRO!
    </canvas>    
</body>

<!-- Testando aqui o script pela questao da rederização dos elementos OBS: não muda nada kkkkk -->
<script>

    const canvas = document.getElementById('canvas1');
    const ctx = canvas.getContext('2d');

    const CANVAS_WIDTH = canvas.width = 600;
    const CANVAS_HEIGHT = canvas.height = 600;

    const playerImage = new Image();
    playerImage.src = 'spritesheet/shadow_dog.png';

    // Cálculo feito a partir das dimensões da imagem .png
    // número de sprites por linha dividido pela largura (width)
    // este tamanho é genérico, porém algumas linhas possuem um número menor  de sprites, então é necessário tratar isso.
    const spriteWidth = 575;
    const spriteHeight = 523;

    let frameX = 0; // linha do corte na src
    let frameY = 8; // coluna

    let gameSlow = 0;
    let timeSlow = 5; // quanto maior este número mais lento fica a troca de sprites

    // cada posição do vetor diz respeito ao número de sprites por linha. o tamanho de todos sprites é igual, porém só varia o numero deles por linha.
    let spriteNumberWidth = [7,7,7,9,11,5,7,7,12,4];

    // apenas com um animation frame funciona também, mas eu optei em fazer desta forma
    playerImage.addEventListener('load',()=>{
            animate();
        }
    );

    function animate(){
        //
        console.log('animate');
        ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
        // ctx.drawImage(img, source_x, source_y, source_w ,source_h, dx, dy , dw, dh)
        ctx.drawImage(playerImage, frameX * spriteWidth , frameY * spriteHeight, spriteWidth, spriteHeight, 0, 0, spriteWidth, spriteHeight);

        // é necessário criar um método para forçar um slow na animação, senão fica a troca de frames (sprites) ficará muito rápida
        if( (gameSlow % timeSlow) == 0){ // se der módulo 0

            if(frameX < spriteNumberWidth[frameY]-1) frameX++; // necessário tratar o numero max de frameX
            else frameX = 0;
        }
        gameSlow++;
        requestAnimationFrame(animate);
        
    };

    //animate();


</script>

</html>